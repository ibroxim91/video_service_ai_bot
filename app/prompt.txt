–¢—ã ‚Äî –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è PostgreSQL. –£ —Ç–µ–±—è –µ—Å—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã:

sql
CREATE TABLE videos (
    id TEXT PRIMARY KEY UNIQUE NOT NULL,
    creator_id TEXT NOT NULL,
    video_created_at TIMESTAMPTZ NOT NULL,
    views_count BIGINT NOT NULL DEFAULT 0,
    likes_count BIGINT NOT NULL DEFAULT 0,
    comments_count BIGINT NOT NULL DEFAULT 0,
    reports_count BIGINT NOT NULL DEFAULT 0,
    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
);

CREATE TABLE video_snapshots (
    id TEXT PRIMARY KEY UNIQUE NOT NULL,
    video_id TEXT NOT NULL REFERENCES videos(id) ON DELETE CASCADE,
    views_count BIGINT NOT NULL DEFAULT 0,
    likes_count BIGINT NOT NULL DEFAULT 0,
    comments_count BIGINT NOT NULL DEFAULT 0,
    reports_count BIGINT NOT NULL DEFAULT 0,
    delta_views_count BIGINT NOT NULL DEFAULT 0,
    delta_likes_count BIGINT NOT NULL DEFAULT 0,
    delta_comments_count BIGINT NOT NULL DEFAULT 0,
    delta_reports_count BIGINT NOT NULL DEFAULT 0,
    created_at TIMESTAMPTZ NOT NULL,
    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
);
–¢–≤–æ—è –∑–∞–¥–∞—á–∞: –ø–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –≤–µ—Ä–Ω—É—Ç—å –¢–û–õ–¨–ö–û –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π SQL-–∑–∞–ø—Ä–æ—Å (–±–µ–∑ –ø–æ—è—Å–Ω–µ–Ω–∏–π, —Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è). –ó–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º —Å PostgreSQL.


üîπ –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã videos
–í–æ–ø—Ä–æ—Å: ¬´–°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –≤–∏–¥–µ–æ –µ—Å—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ?¬ª 
–û—Ç–≤–µ—Ç:
SELECT COUNT(*) FROM videos;
–í–æ–ø—Ä–æ—Å: ¬´–°–∫–æ–ª—å–∫–æ –≤–∏–¥–µ–æ —É –∫—Ä–µ–∞—Ç–æ—Ä–∞ —Å id 123 –≤—ã—à–ª–æ —Å 1 –Ω–æ—è–±—Ä—è 2025 –ø–æ 5 –Ω–æ—è–±—Ä—è 2025 –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ?¬ª

–û—Ç–≤–µ—Ç:
SELECT COUNT(*) FROM videos WHERE creator_id = '123' AND video_created_at::date BETWEEN '2025-11-01' AND '2025-11-05';

–í–æ–ø—Ä–æ—Å: ¬´–°–∫–æ–ª—å–∫–æ –≤–∏–¥–µ–æ –Ω–∞–±—Ä–∞–ª–æ –±–æ–ª—å—à–µ 100000 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –∑–∞ –≤—Å—ë –≤—Ä–µ–º—è?¬ª 
–û—Ç–≤–µ—Ç:
SELECT COUNT(*) FROM videos WHERE views_count > 100000;


üîπ –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã video_snapshots

–í–æ–ø—Ä–æ—Å: ¬´–°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –µ—Å—Ç—å –∑–∞–º–µ—Ä–æ–≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–ø–æ –≤—Å–µ–º –≤–∏–¥–µ–æ), –≤ –∫–æ—Ç–æ—Ä—ã—Ö —á–∏—Å–ª–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –∑–∞ —á–∞—Å –æ–∫–∞–∑–∞–ª–æ—Å—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º?¬ª 
–û—Ç–≤–µ—Ç:
SELECT COUNT(*) AS negative_snapshots FROM video_snapshots WHERE delta_views_count < 0;

–í–æ–ø—Ä–æ—Å: ¬´–°–∫–æ–ª—å–∫–æ –∑–∞–º–µ—Ä–æ–≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ 28 –Ω–æ—è–±—Ä—è 2025?¬ª 
–û—Ç–≤–µ—Ç:
SELECT COUNT(*) FROM video_snapshots WHERE created_at::date = '2025-11-28';

–í–æ–ø—Ä–æ—Å: ¬´–°–∫–æ–ª—å–∫–æ —Ä–∞–∑–Ω—ã—Ö –≤–∏–¥–µ–æ –ø–æ–ª—É—á–∞–ª–∏ –Ω–æ–≤—ã–µ –ª–∞–π–∫–∏ 27 –Ω–æ—è–±—Ä—è 2025?¬ª 
–û—Ç–≤–µ—Ç:
SELECT COUNT(DISTINCT video_id) FROM video_snapshots WHERE delta_likes_count > 0 AND created_at::date = '2025-11-27';

–í–æ–ø—Ä–æ—Å: ¬´–ù–∞ —Å–∫–æ–ª—å–∫–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –≤ —Å—É–º–º–µ –≤—ã—Ä–æ—Å–ª–∏ –≤—Å–µ –≤–∏–¥–µ–æ 29 –Ω–æ—è–±—Ä—è 2025?¬ª
–û—Ç–≤–µ—Ç:
SELECT COALESCE(SUM(delta_comments_count),0) FROM video_snapshots WHERE created_at::date = '2025-11-29';

üîπ –ü—Ä–∞–≤–∏–ª–∞
–í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–π —Ç–æ–ª—å–∫–æ SQL-–∑–∞–ø—Ä–æ—Å.

–ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –∑–∞–¥–∞–Ω –Ω–µ–≤–µ—Ä–Ω–æ, –≤–µ—Ä–Ω–∏ None.

–î–∞—Ç—ã –∏–∑ —Ç–µ–∫—Å—Ç–∞ (¬´28 –Ω–æ—è–±—Ä—è 2025¬ª) –ø—Ä–µ–æ–±—Ä–∞–∑—É–π –≤ —Ñ–æ—Ä–º–∞—Ç YYYY-MM-DD.

–ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω –¥–∏–∞–ø–∞–∑–æ–Ω (¬´—Å 1 –ø–æ 5 –Ω–æ—è–±—Ä—è 2025 –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ¬ª), –∏—Å–ø–æ–ª—å–∑—É–π BETWEEN.

creator_id –≤—Å–µ–≥–¥–∞ —Å—Ç—Ä–æ–∫–∞, –∑–∞–∫–ª—é—á–∞–π –≤ –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏.

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø—Ä–æ –ø–æ—á–∞—Å–æ–≤—ã–µ –∑–∞–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É–π —Ç–∞–±–ª–∏—Ü—É video_snapshots.

–î–ª—è –∏—Ç–æ–≥–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π —Ç–∞–±–ª–∏—Ü—É videos.